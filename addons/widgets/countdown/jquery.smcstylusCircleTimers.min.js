/**
 * jQuery SMCstylus Circle Timers is a jQuery plugin that provides beautiful animated countdowns in circle shapes.
 *
 * Version: 1.0.0
 * Author: Mihai Calin Simion
 * E-mail: simion.mihai.calin@gmail.com
 * Website: http://www.smcstylus.com
 * License: GPLv2 or later
 * License URI: http://www.gnu.org/licenses/gpl-2.0.html
 * Features: You can fill the center of circles, the past time lines and the left time lines with solid or gradient colors. There is aslo the possibility to change the cap style of animated line. Add separate shadow (color and diffuse) for main timer and left time lines and more.
 * Please read the documentation for all the options.
 * This software is based on the original TimeCircles by Wim Barelds ( https://github.com/wimbarelds/TimeCircles ).
 **/
!function(t){var e=window;Object.keys||(Object.keys=function(){"use strict";var t=Object.prototype.hasOwnProperty,e=!{toString:null}.propertyIsEnumerable("toString"),i=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],a=i.length;return function(s){if("object"!=typeof s&&("function"!=typeof s||null===s))throw new TypeError("Object.keys called on non-object");var n,r,o=[];for(n in s)t.call(s,n)&&o.push(n);if(e)for(r=0;r<a;r++)t.call(s,i[r])&&o.push(i[r]);return o}}());var i=!1;location.hash;var a=["Days","Hours","Minutes","Seconds"],s={Seconds:"Minutes",Minutes:"Hours",Hours:"Days",Days:"Years"},n={Seconds:1,Minutes:60,Hours:3600,Days:86400,Months:2678400,Years:31536e3};function r(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function o(t,e){var i=parseInt(t);return i<0||i>180?e:i}function h(t,e,i,a,s){for(var r={},o={},h={},d={},c={},l={},u=null,f=0;f<a.length;f++){var m,p=a[f];m=null===u?i/n[p]:n[u]/n[p];var b=t/n[p],g=e/n[p];s&&(b=b>0?Math.floor(b):Math.ceil(b),g=g>0?Math.floor(g):Math.ceil(g)),"Days"!==p&&(b%=m,g%=m),r[p]=b,h[p]=Math.abs(b),o[p]=g,l[p]=Math.abs(g),d[p]=Math.abs(b)/m,c[p]=Math.abs(g)/m,u=p}return{raw_time:r,raw_old_time:o,time:h,old_time:l,pct:d,old_pct:c}}Array.prototype.indexOf||(Array.prototype.indexOf=function(t){var e=this.length>>>0,i=Number(arguments[1])||0;for((i=i<0?Math.ceil(i):Math.floor(i))<0&&(i+=e);i<e;i++)if(i in this&&this[i]===t)return i;return-1});var d={};function c(){void 0!==e.TC_Instance_List?d=e.TC_Instance_List:e.TC_Instance_List=d,function(t){for(var e=["webkit","moz"],i=0;i<e.length&&!t.requestAnimationFrame;++i)t.requestAnimationFrame=t[e[i]+"RequestAnimationFrame"],t.cancelAnimationFrame=t[e[i]+"CancelAnimationFrame"];t.requestAnimationFrame&&t.cancelAnimationFrame||(t.requestAnimationFrame=function(e,i,a){void 0===a&&(a={data:{lastFrame:0}});var s=(new Date).getTime(),n=Math.max(0,16-(s-a.data.lastFrame)),r=t.setTimeout(function(){e(s+n)},n);return a.data.lastFrame=s+n,r},t.cancelAnimationFrame=function(t){clearTimeout(t)})}(e)}var l=function(t,e){this.element=t,this.container,this.listeners=null,this.data={paused:!1,timer:!1,totalDuration:null,prevTime:null,lastFrame:0,animationFrame:null,intervalFallback:null,drawnUnits:[],textElements:{Days:null,Hours:null,Minutes:null,Seconds:null},attributes:{gradPoints:[],canvas:null,context:null,itemSize:null,lineWidth:null,lineCap:null,radius:null,outerRadius:null},state:{fading:{Days:!1,Hours:!1,Minutes:!1,Seconds:!1}},time:{Days:{show:!1},Hours:{show:!1},Minutes:{show:!1},Seconds:{show:!1}}},this.config=null,this.setOptions(e),this.initialize()};l.prototype.clearListeners=function(){this.listeners={all:[],visible:[]}},l.prototype.addTime=function(t){if(this.data.attributes.referenceDate instanceof Date){var e=this.data.attributes.referenceDate;e.setSeconds(e.getSeconds()+t)}else isNaN(this.data.attributes.referenceDate)||(this.data.attributes.referenceDate+=1e3*t)},l.prototype.initialize=function(a){this.data.drawnUnits=[];for(var s=0;s<Object.keys(this.config.time).length;s++){var n=Object.keys(this.config.time)[s];this.config.time[n].show&&this.data.drawnUnits.push(n)}t(this.element).children("div.smcstylusCircleTimers").remove(),void 0===a&&(a=!0),(a||null===this.listeners)&&this.clearListeners(),this.container=t("<div>"),this.container.addClass("smcstylusCircleTimers").appendTo(this.element),t(this.element).attr("data-tc-act","running");var r=this.element.offsetHeight,h=this.element.offsetWidth;0===r&&(r=t(this.element).height()),0===h&&(h=t(this.element).width()),0===r&&h>0?r=h/this.data.drawnUnits.length:0===h&&r>0&&(h=r*this.data.drawnUnits.length);var d=this.config.pastTimeLineGradPoints;this.data.attributes.gradPoints[0]=o(d[0],0),this.data.attributes.gradPoints[1]=o(d[1],100),this.data.attributes.gradPoints[2]=o(d[2],0),this.data.attributes.gradPoints[3]=o(d[3],0);var c=document.createElement("canvas");c.width=h,c.height=r,this.data.attributes.canvas=t(c),this.data.attributes.canvas.appendTo(this.container);var l,u=!(!(l=document.createElement("canvas")).getContext||!l.getContext("2d"));u||"undefined"==typeof G_vmlCanvasManager||(G_vmlCanvasManager.initElement(c),i=!0,u=!0),u&&(this.data.attributes.context=c.getContext("2d")),this.data.attributes.itemSize=Math.min(h/this.data.drawnUnits.length,r),this.data.attributes.lineCap=this.config.leftTimeLineCap,this.data.attributes.lineWidth=this.data.attributes.itemSize*this.config.leftTimeLineWidth,this.data.attributes.radius=(.8*this.data.attributes.itemSize-this.data.attributes.lineWidth)/2,this.data.attributes.outerRadius=this.data.attributes.radius+.5*Math.max(this.data.attributes.lineWidth,this.data.attributes.lineWidth*this.config.pastTimeLineWith);s=0;for(var f in this.data.textElements)if(this.config.time[f].show){var m=t("<div>");m.addClass("smcstylusCircleTimers--inner-"+f).css("top",Math.round(.35*this.data.attributes.itemSize)).css("left",Math.round(s++*this.data.attributes.itemSize)).css("width",this.data.attributes.itemSize).appendTo(this.container),t("<h4>").addClass("smcstylusCircleTimers--label").text(this.config.time[f].text).css("font-size",Math.round(this.config.labelSize*this.data.attributes.itemSize)).appendTo(m);var p=t("<span>");p.addClass("smcstylusCircleTimers--number").css("font-size",Math.round(this.config.numberSize*this.data.attributes.itemSize)).appendTo(m),this.data.textElements[f]=p}this.start(),this.config.start||(this.data.paused=!0);var b=this;this.data.intervalFallback=e.setInterval(function(){b.update.call(b,!0)},100)},l.prototype.update=function(s){if(void 0===s)s=!1;else if(s&&this.data.paused)return;var r,o;i&&this.data.attributes.context.clearRect(0,0,this.data.attributes.canvas[0].width,this.data.attributes.canvas[0].hright);var d=this.data.prevTime,c=new Date;if(this.data.prevTime=c,null===d&&(d=c),!this.config.countPastZero&&c>this.data.attributes.referenceDate){for(var l=0;l<this.data.drawnUnits.length;l++){var u=this.data.drawnUnits[l];this.data.textElements[u].text("0");var f=l*this.data.attributes.itemSize+this.data.attributes.itemSize/2,m=this.data.attributes.itemSize/2,p=this.config.time[u].color;this.drawArc(f,m,p,0,u)}return t(this.element).attr("data-tc-act","ended"),void this.stop()}r=(this.data.attributes.referenceDate-c)/1e3,o=(this.data.attributes.referenceDate-d)/1e3;var b="smooth"!==this.config.animation,g=h(r,o,this.data.totalDuration,this.data.drawnUnits,b),v=h(r,o,n.Years,a,b),w=(l=0,0),y=null,x=this.data.drawnUnits.slice();for(var l in a){u=a[l];if(Math.floor(v.raw_time[u])!==Math.floor(v.raw_old_time[u])&&this.notifyListeners(u,Math.floor(v.time[u]),Math.floor(r),"all"),!(x.indexOf(u)<0)){if(Math.floor(g.raw_time[u])!==Math.floor(g.raw_old_time[u])&&this.notifyListeners(u,Math.floor(g.time[u]),Math.floor(r),"visible"),!s){var T=Math.floor(Math.abs(g.time[u]));this.data.textElements[u].text(T),!0===this.config.effects.fadeSeconds&&"seconds"===u.toLowerCase()&&(t(this.data.textElements[u]).animate({opacity:0},500),t(this.data.textElements[u]).animate({opacity:1},500));f=w*this.data.attributes.itemSize+this.data.attributes.itemSize/2,m=this.data.attributes.itemSize/2,p=this.config.time[u].color;"smooth"===this.config.animation?(null===y||i||(Math.floor(g.time[y])>Math.floor(g.old_time[y])?(this.radialFade(f,m,p,1,u),this.data.state.fading[u]=!0):Math.floor(g.time[y])<Math.floor(g.old_time[y])&&(this.radialFade(f,m,p,0,u),this.data.state.fading[u]=!0)),this.data.state.fading[u]||this.drawArc(f,m,p,g.pct[u],u)):this.animateArc(f,m,p,g.pct[u],g.old_pct[u],(new Date).getTime()+200,u)}y=u,w++}}if(!this.data.paused&&!s){var S=this,C=function(){S.update.call(S)};if("smooth"===this.config.animation)this.data.animationFrame=e.requestAnimationFrame(C,S.element,S);else{var L=r%1*1e3;L<0&&(L=1e3+L),L+=50,S.data.animationFrame=e.setTimeout(function(){S.data.animationFrame=e.requestAnimationFrame(C,S.element,S)},L)}}},l.prototype.animateArc=function(t,i,a,s,n,r,o){if(null!==this.data.attributes.context){var h=n-s;if(Math.abs(h)>.5)0===s?this.radialFade(t,i,a,1,o):this.radialFade(t,i,a,0,o);else{var d=(200-(r-(new Date).getTime()))/200;d>1&&(d=1);var c=n*(1-d)+s*d;if(this.drawArc(t,i,a,c,o),d>=1)return;var l=this;e.requestAnimationFrame(function(){l.animateArc(t,i,a,s,n,r,o)},this.element)}}},l.prototype.drawArc=function(t,e,a,s,n){this.data.attributes;if(null!==this.data.attributes.context){var r,o,h,d=Math.max(this.data.attributes.outerRadius,this.data.attributes.itemSize/2);if(i||this.data.attributes.context.clearRect(t-d,e-d,2*d,2*d),this.data.attributes.context.lineWidth=0,this.data.attributes.context.setLineDash([]),this.data.attributes.context.strokeStyle="#00000000",this.data.attributes.context.shadowBlur=0,this.data.attributes.context.shadowOffsetX=0,this.data.attributes.context.shadowOffsetY=0,this.data.attributes.context.shadowColor="#00000000",this.data.attributes.context.fillStyle="#00000000",!0===this.config.pastTimeLineShow||!0===this.config.innerFill){if(this.data.attributes.context.beginPath(),this.data.attributes.context.arc(t,e,this.data.attributes.radius,0,2*Math.PI,!1),!0===this.config.innerFill){var c=this.data.attributes.context.createRadialGradient(t,e,parseInt(this.config.innerCenterSize),t,e,this.data.attributes.radius);c.addColorStop(0,this.config.innerBackgroundColors[0]),!0===this.config.innerUseGradient&&c.addColorStop(1,this.config.innerBackgroundColors[1]),this.data.attributes.context.fillStyle=c,this.data.attributes.context.shadowBlur=this.config.innerShadowBlur,this.data.attributes.context.shadowColor=this.config.innerShadowColor,this.data.attributes.context.fill()}var l,u;if(!0===this.config.pastTimeLineShow)this.data.attributes.context.lineWidth=0,this.data.attributes.context.setLineDash([]),this.data.attributes.context.strokeStyle="#00000000",this.data.attributes.context.shadowBlur=0,this.data.attributes.context.shadowOffsetX=0,this.data.attributes.context.shadowOffsetY=0,this.data.attributes.context.shadowColor="transparent",this.data.attributes.context.fillStyle="#00000000",!0!==this.config.pastTimeLineUseGradient||1===this.config.pastTimeLineColors.length?u=this.config.pastTimeLineColors[0]:((l=this.data.attributes.context.createLinearGradient(this.config.pastTimeLineGradPoints[0],this.config.pastTimeLineGradPoints[1],this.config.pastTimeLineGradPoints[2],this.config.pastTimeLineGradPoints[3])).addColorStop(0,this.config.pastTimeLineColors[0]),l.addColorStop(1,this.config.pastTimeLineColors[1]),u=l),this.data.attributes.context.lineWidth=this.data.attributes.lineWidth*this.config.pastTimeLineWith,this.data.attributes.context.strokeStyle=u,this.data.attributes.context.shadowBlur=this.config.pastTimeLineShadowBlur,this.data.attributes.context.shadowColor=this.config.pastTimeLineShadowColor,this.data.attributes.context.shadowOffsetX=this.config.pastTimeLineShadowCoordinates[0],this.data.attributes.context.shadowOffsetY=this.config.pastTimeLineShadowCoordinates[1],this.data.attributes.context.stroke()}this.data.attributes.context.lineWidth=0,this.data.attributes.context.setLineDash([]),this.data.attributes.context.strokeStyle="#00000000",this.data.attributes.context.shadowBlur=0,this.data.attributes.context.shadowOffsetX=0,this.data.attributes.context.shadowOffsetY=0,this.data.attributes.context.shadowColor="#00000000",this.data.attributes.context.fillStyle="#00000000";var f=-.5*Math.PI,m=2*Math.PI;r=f+this.config.startAngle/360*m;var p,b,g=2*s*Math.PI;"both"===this.config.direction.toLowerCase()?(h=!1,o=(r-=g/2)+g):"clockwise"===this.config.direction.toLowerCase()?(h=!1,o=r+g):(h=!0,o=r-g),!0===this.config.leftTimeLineIndividualColors?!0===this.config.time[n].gradient||this.config.time[n].color.length>1?((p=this.data.attributes.context.createLinearGradient(0,100,0,0)).addColorStop(0,this.config.time[n].color[0]),p.addColorStop(1,this.config.time[n].color[1]),b=p):b=a[0]:!0===this.config.leftTimeLineUseGradient?((p=this.data.attributes.context.createLinearGradient(0,100,0,0)).addColorStop(0,this.config.leftTimeLineColors[0]),p.addColorStop(1,this.config.leftTimeLineColors[1]),b=p):b=this.config.leftTimeLineColors[0],this.data.attributes.context.shadowOffsetX=0,this.data.attributes.context.shadowOffsetY=0,this.data.attributes.context.shadowBlur=this.config.leftTimeLineShadowBlur,this.data.attributes.context.shadowColor=this.config.leftTimeLineShadowColor,this.data.attributes.context.beginPath(),this.data.attributes.context.arc(t,e,this.data.attributes.radius,r,o,h),this.data.attributes.context.setLineDash(function(t){var e=[];switch(t){case"1":e=[1,1];break;case"2":e=[1,5];break;case"3":e=[5,1];break;case"4":e=[1,5,5];break;case"5":e=[3,3];break;case"6":e=[10,10];break;case"0":default:e=[]}return e}(this.config.leftTimeLineUIEffect)),this.data.attributes.context.lineWidth=this.data.attributes.lineWidth,this.data.attributes.context.strokeStyle=b,this.data.attributes.context.lineCap=this.data.attributes.lineCap,this.data.attributes.context.stroke()}},l.prototype.radialFade=function(t,i,a,s,n){var r,o,h=this,d=.2*(1===s?-1:1);for(r=0;s<=1&&s>=0;r++)o=void 0,o=50*r,e.setTimeout(function(){h.drawArc(t,i,a,1,n)},o),s+=d;void 0!==typeof n&&e.setTimeout(function(){h.data.state.fading[n]=!1},50*r)},l.prototype.timeLeft=function(){if(this.data.paused&&"number"==typeof this.data.timer)return this.data.timer;var t=new Date;return(this.data.attributes.referenceDate-t)/1e3},l.prototype.start=function(){e.cancelAnimationFrame(this.data.animationFrame),e.clearTimeout(this.data.animationFrame);var i=t(this.element).data("date");if(void 0===i&&(i=t(this.element).attr("data-date")),"string"==typeof i)this.data.attributes.referenceDate=function(t){var e=t.match(/^[0-9]{4}-[0-9]{2}-[0-9]{2}\s[0-9]{1,2}:[0-9]{2}:[0-9]{2}$/);if(null!==e&&e.length>0){var i=t.split(" "),a=i[0].split("-"),s=i[1].split(":");return new Date(a[0],a[1]-1,a[2],s[0],s[1],s[2])}var n=Date.parse(t);return isNaN(n)?(n=Date.parse(t.replace(/-/g,"/").replace("T"," ")),isNaN(n)?new Date:n):n}(i);else if("number"==typeof this.data.timer)this.data.paused&&(this.data.attributes.referenceDate=(new Date).getTime()+1e3*this.data.timer);else{var a=t(this.element).data("timer");void 0===a&&(a=t(this.element).attr("data-timer")),"string"==typeof a&&(a=parseFloat(a)),"number"==typeof a?(this.data.timer=a,this.data.attributes.referenceDate=(new Date).getTime()+1e3*a):this.data.attributes.referenceDate=this.config.referenceDate}this.data.paused=!1,this.update.call(this)},l.prototype.restart=function(){this.data.timer=!1,this.start()},l.prototype.stop=function(){"number"==typeof this.data.timer&&(this.data.timer=this.timeLeft(this)),this.data.paused=!0,e.cancelAnimationFrame(this.data.animationFrame)},l.prototype.destroy=function(){this.clearListeners(),this.stop(),e.clearInterval(this.data.intervalFallback),this.data.intervalFallback=null,this.container.remove(),t(this.element).removeAttr("data-tc-id"),t(this.element).removeData("tc-id")},l.prototype.setOptions=function(i){if(null===this.config&&(this.default_options.referenceDate=new Date,this.config=t.extend(!0,{},this.default_options)),t.extend(!0,this.config,i),e=this.config.useTopFrame?window.top:window,c(),this.data.totalDuration=this.config.totalDuration,"string"==typeof this.data.totalDuration)if(void 0!==n[this.data.totalDuration])this.data.totalDuration=n[this.data.totalDuration];else if("Auto"===this.data.totalDuration)for(var a=0;a<Object.keys(this.config.time).length;a++){var r=Object.keys(this.config.time)[a];if(this.config.time[r].show){this.data.totalDuration=n[s[r]];break}}else this.data.totalDuration=n.Years,console.error("Valid values for SMCstylus Circle Timers config.totalDuration are: either numeric, or (string) Years, Months, Days, Hours, Minutes, Auto")},l.prototype.addListener=function(t,e,i){"function"==typeof t&&(void 0===i&&(i="visible"),this.listeners[i].push({func:t,scope:e}))},l.prototype.notifyListeners=function(t,e,i,a){for(var s=0;s<this.listeners[a].length;s++){var n=this.listeners[a][s];n.func.apply(n.scope,[t,e,i])}},l.prototype.default_options={referenceDate:new Date,countPastZero:!1,useTopFrame:!1,labelSize:.07,numberSize:.28,start:!0,animation:"smooth",direction:"Clockwise",totalDuration:"Auto",startAngle:0,innerFill:!1,innerUseGradient:!1,innerBackgroundColors:["#f6008b11","transparent"],innerCenterSize:5,innerShadowBlur:0,innerShadowColor:"#55cc00",pastTimeLineShow:!0,pastTimeLineWith:1.2,pastTimeLineUseGradient:!0,pastTimeLineColors:["#ffcc33","#f6008b44"],pastTimeLineGradPoints:[60,180,0,0],pastTimeLineShadowBlur:10,pastTimeLineShadowColor:"rgba(0,0,0, 0.5)",pastTimeLineShadowCoordinates:[0,0],leftTimeLineWidth:.1,leftTimeLineCap:"round",leftTimeLineUseGradient:!0,leftTimeLineColors:["#f6008b","#cc55ff"],leftTimeLineIndividualColors:!1,leftTimeLineShadowBlur:10,leftTimeLineShadowColor:"red",leftTimeLineShadowCoordinates:[0,0],leftTimeLineUIEffect:0,effects:{fadeSeconds:!1,autoFade:!1},time:{Days:{show:!0,text:"Days",color:["#f6008b"],gradient:!0},Hours:{show:!0,text:"Hours",color:["#f6008b"],gradient:!0},Minutes:{show:!0,text:"Minutes",color:["#f6008b"],gradient:!0},Seconds:{show:!0,text:"Seconds",color:["#f6008b"],gradient:!0}}};var u=function(t,e){this.elements=t,this.options=e,this.foreach()};u.prototype.getInstance=function(e){var i,a=t(e).data("tc-id");if(void 0===a&&(a=r()+r()+"-"+r()+"-"+r()+"-"+r()+"-"+r()+r()+r(),t(e).attr("data-tc-id",a)),void 0===d[a]){var s=this.options,n=t(e).data("options");"string"==typeof n&&(n=JSON.parse(n)),"object"==typeof n&&(s=t.extend(!0,{},this.options,n)),i=new l(e,s),d[a]=i}else i=d[a],void 0!==this.options&&i.setOptions(this.options);return i},u.prototype.addTime=function(t){this.foreach(function(e){e.addTime(t)})},u.prototype.foreach=function(t){var e=this;return this.elements.each(function(){var i=e.getInstance(this);"function"==typeof t&&t(i)}),this},u.prototype.start=function(){return this.foreach(function(t){t.start()}),this},u.prototype.stop=function(){return this.foreach(function(t){t.stop()}),this},u.prototype.restart=function(){return this.foreach(function(t){t.restart()}),this},u.prototype.rebuild=function(){return this.foreach(function(t){t.initialize(!1)}),this},u.prototype.getTime=function(){return this.getInstance(this.elements[0]).timeLeft()},u.prototype.addListener=function(t,e){void 0===e&&(e="visible");var i=this;return this.foreach(function(a){a.addListener(t,i.elements,e)}),this},u.prototype.destroy=function(){return this.foreach(function(t){t.destroy()}),this},u.prototype.end=function(){return this.elements},t.fn.smcstylusCircleTimers=function(t){return new u(this,t)}}(jQuery);